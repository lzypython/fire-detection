# fire-detection
0、写在前面
	代码拿过去完全可以运行，如果只是应付课设，大作业下面都可以不看了。
	如果是毕业设计或者是比赛要求，需要实现特定场景可以看下面的操作教程：
一、	如何设置数据集格式
本模型为yolov5。数据集格式要严格按照标准格式来，这样后面修改数据集配置文件就容易很多。一般包括train文件夹和val文件夹，每一个文件夹下有与图片同名的txt文件。数据集按如下格式设置：
|–score
||–images
|||–test
    –Img图片
  |||–train
–Img图片
  |||–val
–Img图片

||–labels
|||–test
	-txt标签
  |||–train
		-txt标签
  |||–val
-txt标签

txt的标签如下图所示：
 
第一列为目标类别，后面四个数字为方框左上角与右下角的坐标，可以看到都是小于1的数字，是因为对应的整张图片的比例，所以就算图像被拉伸放缩，这种txt格式的标签也可以找到相应的目标。
二、	如何修改模型配置文件：
第一步：修改数据集的配置文件：data/mask_data.yaml：
	修改train的路径 注意是 /（反斜杠）
Eg: D:/lingjian/score/images/train
	修改val的路径
Eg: D:/lingjian/score/images/val
	修改类别 nc ：1、2  有几类设置成几
	names [“标签名称1”、“标签名称2”]  # 按自己txt标签中012…的顺序写
第二步：修改模型配置文件： models/mask_yolov5s.yaml
	修改类别个数 nc：1、2


三、	如何训练模型
在完成上面两步后，就可以开始训练模型了。无论你是CPU还是GPU都可以进行训练，只是时间长短的问题。
在pycharm终端输入：
python train.py --data mask_data.yaml --cfg mask_yolov5s.yaml --weights pretrained/yolov5s.pt --epoch 100 --batch-size 2 --device cpu
	上述代码在train.py最后面有，可以直接复制
	python：运行python
	train.py：运行train.py文件
	--data:数据的配置文件，也就是我们在上一步进行修改的文件mask_data.yaml
	--cfg:模型配置文件，这里采用之前修改的模型配置文件 mask_yolov5s.yaml
	--weights:预训练的权重文件
	--epoch:迭代次数，及训练多少轮，可以根据实际需要调整
	--batch-size:一次读取多少张，需要根据自己电脑去设置，如果电脑性能不好，batch-size要设置小一点，防止内存满了直接报错。
	--device:使用CPU训练还是GPU训练


按回车即可开始训练，接下来就是漫长的等待时间：
 

四、	模型推理测试
运行windows.py文件，下面以火灾检测为例：
注：如果你想调用自己训练好的模型，只需要更改windows.py 59行训练好的权重文件路径就可以了。
 
UI界面包括图片检测和视频检测，在左上角可以切换。
图片检测中，图片路径以及图片名不要出现中文！否则程序不能识别直接卡死！
图片检测先上传文件，再点击开始检测。检测结果会并排显示。
 
视频检测即调用本地的摄像头，对画面实时检测。
电脑配置不同，视频的帧数不同。如果电脑配置不够，会出现轻微的延迟现象也是正常的。

五、	UI界面更改
可以根据不同的应用场景，更换UI界面，让用户有更好的体验感（老师多给点分）。
更换UI界面只需要更换图片地址即可。
Images/UI存的即为UI图片。
UI的右侧图片为images/UI/nixing.jpg
由于多个地方都会用这个图片，所以建议把你想要的图片拖到UI文件夹，也起名为nixing.jpg，覆盖原来的图片。这样就不用改代码了。
当然，左侧图片和应用标志也可以用这样的方法。


PS、写在最后
	有任何问题都欢迎直接来咨询我，在我能力范围内，我会详细给大家解答。
	环境配置很重要，推荐conda创建虚拟环境，
	建议大家养成好习惯，文件名、图片名都不要出现中文。
	代码能少改就少改，能完成基本任务就行，比如说UI界面。
	在开始训练模型之前，请确保你的环境是适宜的，如电脑连接充电线，关闭长时间无操作自动进入休眠状态等。
	如果只想要模型识别效果更好一些，可以把epoch调大一点，让模型过拟合。演示的时候就用训练的图片，这样的精度会高很多。
	祝大家生活愉快，学业有成！
